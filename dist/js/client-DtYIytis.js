var T=Object.defineProperty,k=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var S=(a,t,s)=>t in a?T(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,w=(a,t)=>{for(var s in t||(t={}))R.call(t,s)&&S(a,s,t[s]);if(h)for(var s of h(t))j.call(t,s)&&S(a,s,t[s]);return a},A=(a,t)=>k(a,C(t));import{cx as D,cy as I,ca as o,bN as g}from"./bootstrap-CPnRZazZ.js";function q(a,t){const s=new D(A(w({},t),{baseURL:a,timeout:1e4}));return s.addRequestInterceptor({fulfilled:e=>{e.metadata={startTime:Date.now()},e.data instanceof FormData||(e.headers=e.headers||{},e.headers["Content-Type"]="application/json");let r=sessionStorage.getItem("token");return r||(r=I().accessToken),r&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${r}`),e},rejected:e=>(console.error("❌ Mira API Request Interceptor Error:",e),Promise.reject(e))}),s.addResponseInterceptor({fulfilled:e=>{var r;return Date.now()-(((r=e.config.metadata)==null?void 0:r.startTime)||0),e},rejected:e=>{var r,n,i,c,l,d,m,p,u;if(Date.now()-(((n=(r=e.config)==null?void 0:r.metadata)==null?void 0:n.startTime)||0),((i=e.response)==null?void 0:i.status)===401)sessionStorage.removeItem("token"),localStorage.removeItem("token"),sessionStorage.clear(),I().setAccessToken(null),window.location.pathname!=="/login"&&(window.location.href="/login",o.error("登录已过期，请重新登录"));else if(((c=e.response)==null?void 0:c.status)>=500)o.error("服务器错误，请稍后重试");else if(((l=e.response)==null?void 0:l.status)>=400){const f=((m=(d=e.response)==null?void 0:d.data)==null?void 0:m.message)||((u=(p=e.response)==null?void 0:p.data)==null?void 0:u.error)||"请求失败";o.error(f)}else e.code==="ECONNABORTED"?o.error("请求超时，请检查网络连接"):e.response||o.error("网络连接失败，请检查网络设置");return Promise.reject(e)}}),s}const{apiURL:E}=g(),P=q(E);export{P as m};
